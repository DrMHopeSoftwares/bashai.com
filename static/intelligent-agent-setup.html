<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intelligent Agent Setup - BhashAI</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --primary: #6366f1;
            --secondary: #8b5cf6;
            --accent: #06b6d4;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1f2937;
            --light: #f8fafc;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .glassmorphism {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .intelligence-card {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
            border: 2px solid rgba(99, 102, 241, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .intelligence-card:hover {
            border-color: var(--primary);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.15);
            transform: translateY(-2px);
        }

        .feature-toggle {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .feature-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background: var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .personality-slider {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e2e8f0;
            outline: none;
        }

        .personality-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
        }

        .knowledge-upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .knowledge-upload-area:hover {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.05);
        }

        .knowledge-upload-area.dragover {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
        }

        .flow-designer {
            background: #f8fafc;
            border-radius: 12px;
            padding: 1rem;
            min-height: 300px;
            position: relative;
            overflow: auto;
        }

        .flow-node {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
            margin: 0.5rem;
            display: inline-block;
            min-width: 150px;
            cursor: move;
            transition: all 0.3s ease;
        }

        .flow-node:hover {
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .flow-node.selected {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
        }

        .analytics-chart {
            background: white;
            border-radius: 12px;
            padding: 1rem;
            margin: 1rem 0;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #e2e8f0;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .tab-button {
            padding: 0.75rem 1.5rem;
            border: none;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            margin-right: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-button.active {
            background: var(--primary);
            color: white;
        }

        .progress-ring {
            transform: rotate(-90deg);
        }

        .progress-ring__circle {
            transition: stroke-dashoffset 0.35s;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }

        .conversation-preview {
            background: #f8fafc;
            border-radius: 12px;
            padding: 1rem;
            max-height: 300px;
            overflow-y: auto;
        }

        .message-bubble {
            margin: 0.5rem 0;
            padding: 0.75rem;
            border-radius: 12px;
            max-width: 80%;
        }

        .user-message {
            background: #e6fffa;
            margin-left: auto;
            text-align: right;
        }

        .agent-message {
            background: white;
            border: 1px solid #e2e8f0;
        }

        .intelligence-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .metric-card {
            background: white;
            padding: 1rem;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            text-align: center;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
        }

        .metric-label {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="min-h-screen p-6">
        <div class="max-w-7xl mx-auto">
            <!-- Header -->
            <div class="glassmorphism rounded-2xl p-6 mb-6">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">🧠 Intelligent Agent Setup</h1>
                        <p class="text-gray-600">Create an AI agent with advanced intelligence and conversation capabilities</p>
                    </div>
                    <div class="flex gap-3">
                        <button class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition">
                            <i class="fas fa-save mr-2"></i>Save Draft
                        </button>
                        <button class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition" onclick="testAgent()">
                            <i class="fas fa-play mr-2"></i>Test Agent
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tab Navigation -->
            <div class="glassmorphism rounded-2xl p-6 mb-6">
                <div class="flex flex-wrap gap-2 mb-6">
                    <button class="tab-button active" onclick="showTab('basic')" id="basic-tab">
                        <i class="fas fa-user-cog mr-2"></i>Basic Setup
                    </button>
                    <button class="tab-button" onclick="showTab('intelligence')" id="intelligence-tab">
                        <i class="fas fa-brain mr-2"></i>Intelligence Features
                    </button>
                    <button class="tab-button" onclick="showTab('knowledge')" id="knowledge-tab">
                        <i class="fas fa-database mr-2"></i>Knowledge Base
                    </button>
                    <button class="tab-button" onclick="showTab('conversation')" id="conversation-tab">
                        <i class="fas fa-comments mr-2"></i>Conversation Flows
                    </button>
                    <button class="tab-button" onclick="showTab('analytics')" id="analytics-tab">
                        <i class="fas fa-chart-line mr-2"></i>Analytics & Testing
                    </button>
                </div>

                <!-- Basic Setup Tab -->
                <div id="basic-content" class="tab-content active">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-6">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Agent Name *</label>
                                <input type="text" id="agentName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent" placeholder="e.g., Dr. Smart Assistant" value="Dr. Smart Assistant">
                            </div>

                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Description</label>
                                <textarea id="agentDescription" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent" rows="3" placeholder="Describe your agent's role and capabilities...">Intelligent healthcare assistant with advanced conversation capabilities and multi-language support.</textarea>
                            </div>

                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Agent Type</label>
                                <select id="agentType" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent" onchange="updateAgentTypeFeatures()">
                                    <option value="healthcare_assistant">Healthcare Assistant</option>
                                    <option value="customer_service">Customer Service</option>
                                    <option value="sales_representative">Sales Representative</option>
                                    <option value="appointment_scheduler">Appointment Scheduler</option>
                                    <option value="technical_support">Technical Support</option>
                                    <option value="custom">Custom Agent</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-4">Supported Languages</label>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" checked class="mr-3 w-4 h-4 text-indigo-600 rounded">
                                        <span>🇮🇳 Hindi (हिंदी)</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" checked class="mr-3 w-4 h-4 text-indigo-600 rounded">
                                        <span>🇬🇧 English</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" checked class="mr-3 w-4 h-4 text-indigo-600 rounded">
                                        <span>🔄 Hinglish (Code-switching)</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="mr-3 w-4 h-4 text-indigo-600 rounded">
                                        <span>🇮🇳 Marathi (मराठी)</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="mr-3 w-4 h-4 text-indigo-600 rounded">
                                        <span>🇮🇳 Tamil (தமிழ்)</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="space-y-6">
                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-robot mr-2 text-indigo-600"></i>
                                    Agent Personality
                                </h3>
                                
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Response Style</label>
                                        <select id="responseStyle" class="w-full p-2 border border-gray-300 rounded-lg">
                                            <option value="professional">Professional</option>
                                            <option value="friendly">Friendly</option>
                                            <option value="empathetic" selected>Empathetic</option>
                                            <option value="casual">Casual</option>
                                            <option value="authoritative">Authoritative</option>
                                        </select>
                                    </div>

                                    <div>
                                        <label class="flex justify-between text-sm font-medium text-gray-700 mb-2">
                                            <span>Empathy Level</span>
                                            <span id="empathyValue">0.9</span>
                                        </label>
                                        <input type="range" id="empathyLevel" class="personality-slider" min="0" max="1" step="0.1" value="0.9" oninput="updateSliderValue('empathy', this.value)">
                                    </div>

                                    <div>
                                        <label class="flex justify-between text-sm font-medium text-gray-700 mb-2">
                                            <span>Formality Level</span>
                                            <span id="formalityValue">0.6</span>
                                        </label>
                                        <input type="range" id="formalityLevel" class="personality-slider" min="0" max="1" step="0.1" value="0.6" oninput="updateSliderValue('formality', this.value)">
                                    </div>

                                    <div>
                                        <label class="flex justify-between text-sm font-medium text-gray-700 mb-2">
                                            <span>Patience Level</span>
                                            <span id="patienceValue">0.8</span>
                                        </label>
                                        <input type="range" id="patienceLevel" class="personality-slider" min="0" max="1" step="0.1" value="0.8" oninput="updateSliderValue('patience', this.value)">
                                    </div>

                                    <div>
                                        <label class="flex justify-between text-sm font-medium text-gray-700 mb-2">
                                            <span>Detail Level</span>
                                            <span id="detailValue">0.7</span>
                                        </label>
                                        <input type="range" id="detailLevel" class="personality-slider" min="0" max="1" step="0.1" value="0.7" oninput="updateSliderValue('detail', this.value)">
                                    </div>
                                </div>
                            </div>

                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-eye mr-2 text-indigo-600"></i>
                                    Quick Preview
                                </h3>
                                <div class="conversation-preview">
                                    <div class="message-bubble agent-message">
                                        <div class="font-medium text-sm text-gray-600 mb-1">Agent</div>
                                        <div id="previewMessage">नमस्ते! मैं Dr. Smart Assistant हूं। मैं आपकी स्वास्थ्य संबंधी सहायता कर सकता हूं। आपकी कैसे मदद कर सकता हूं?</div>
                                    </div>
                                    <div class="message-bubble user-message">
                                        <div class="font-medium text-sm text-gray-600 mb-1">User</div>
                                        <div>Hello, मुझे appointment book करना है</div>
                                    </div>
                                    <div class="message-bubble agent-message">
                                        <div class="font-medium text-sm text-gray-600 mb-1">Agent</div>
                                        <div>बिल्कुल! मैं आपका appointment book करने में help करूंगा। Please बताएं आपका name और preferred date?</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Intelligence Features Tab -->
                <div id="intelligence-content" class="tab-content">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-6">
                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-brain mr-2 text-indigo-600"></i>
                                    Natural Language Understanding
                                </h3>
                                
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Intent Recognition</div>
                                            <div class="text-sm text-gray-600">Automatically detect user intentions</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Entity Extraction</div>
                                            <div class="text-sm text-gray-600">Extract names, dates, numbers automatically</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Context Memory</div>
                                            <div class="text-sm text-gray-600">Remember conversation history and context</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Multi-turn Conversations</div>
                                            <div class="text-sm text-gray-600">Handle complex conversation flows</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-heart mr-2 text-indigo-600"></i>
                                    Emotional Intelligence
                                </h3>
                                
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Sentiment Analysis</div>
                                            <div class="text-sm text-gray-600">Detect user emotions in real-time</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Empathetic Responses</div>
                                            <div class="text-sm text-gray-600">Respond appropriately to emotions</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Tone Adaptation</div>
                                            <div class="text-sm text-gray-600">Adjust tone based on user mood</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-language mr-2 text-indigo-600"></i>
                                    Advanced Language Features
                                </h3>
                                
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Smart Code-switching</div>
                                            <div class="text-sm text-gray-600">Natural Hindi-English mixing</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Language Detection</div>
                                            <div class="text-sm text-gray-600">Auto-detect user's language preference</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Cultural Context</div>
                                            <div class="text-sm text-gray-600">Understand cultural nuances</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="space-y-6">
                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-cogs mr-2 text-indigo-600"></i>
                                    Intelligence Metrics
                                </h3>
                                
                                <div class="intelligence-metrics">
                                    <div class="metric-card">
                                        <div class="metric-value" id="nluScore">92%</div>
                                        <div class="metric-label">NLU Accuracy</div>
                                    </div>
                                    <div class="metric-card">
                                        <div class="metric-value" id="contextScore">88%</div>
                                        <div class="metric-label">Context Retention</div>
                                    </div>
                                    <div class="metric-card">
                                        <div class="metric-value" id="emotionScore">95%</div>
                                        <div class="metric-label">Emotion Detection</div>
                                    </div>
                                    <div class="metric-card">
                                        <div class="metric-value" id="responseTime">0.8s</div>
                                        <div class="metric-label">Avg Response Time</div>
                                    </div>
                                </div>
                            </div>

                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-chart-pie mr-2 text-indigo-600"></i>
                                    Intelligence Breakdown
                                </h3>
                                
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm font-medium">Natural Language Processing</span>
                                        <div class="flex items-center">
                                            <div class="w-32 bg-gray-200 rounded-full h-2 mr-3">
                                                <div class="bg-indigo-600 h-2 rounded-full" style="width: 92%"></div>
                                            </div>
                                            <span class="text-sm">92%</span>
                                        </div>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <span class="text-sm font-medium">Conversation Management</span>
                                        <div class="flex items-center">
                                            <div class="w-32 bg-gray-200 rounded-full h-2 mr-3">
                                                <div class="bg-green-500 h-2 rounded-full" style="width: 88%"></div>
                                            </div>
                                            <span class="text-sm">88%</span>
                                        </div>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <span class="text-sm font-medium">Emotional Intelligence</span>
                                        <div class="flex items-center">
                                            <div class="w-32 bg-gray-200 rounded-full h-2 mr-3">
                                                <div class="bg-purple-500 h-2 rounded-full" style="width: 95%"></div>
                                            </div>
                                            <span class="text-sm">95%</span>
                                        </div>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <span class="text-sm font-medium">Knowledge Integration</span>
                                        <div class="flex items-center">
                                            <div class="w-32 bg-gray-200 rounded-full h-2 mr-3">
                                                <div class="bg-blue-500 h-2 rounded-full" style="width: 85%"></div>
                                            </div>
                                            <span class="text-sm">85%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-graduation-cap mr-2 text-indigo-600"></i>
                                    Learning & Adaptation
                                </h3>
                                
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Continuous Learning</div>
                                            <div class="text-sm text-gray-600">Learn from conversation feedback</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Performance Optimization</div>
                                            <div class="text-sm text-gray-600">Auto-optimize based on success metrics</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Personalization</div>
                                            <div class="text-sm text-gray-600">Adapt to individual user preferences</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Knowledge Base Tab -->
                <div id="knowledge-content" class="tab-content">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-6">
                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-upload mr-2 text-indigo-600"></i>
                                    Upload Knowledge Sources
                                </h3>
                                
                                <div class="knowledge-upload-area" id="knowledgeUpload" onclick="document.getElementById('fileInput').click()">
                                    <div class="text-4xl text-gray-400 mb-4">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                    </div>
                                    <h4 class="text-lg font-medium text-gray-700 mb-2">Upload Knowledge Files</h4>
                                    <p class="text-gray-500 mb-4">Drag and drop files or click to browse</p>
                                    <p class="text-sm text-gray-400">Supported: PDF, DOCX, TXT, CSV, JSON</p>
                                    <input type="file" id="fileInput" multiple accept=".pdf,.docx,.txt,.csv,.json" style="display: none;" onchange="handleFileUpload(this.files)">
                                </div>

                                <div class="mt-4">
                                    <h4 class="font-medium text-gray-700 mb-3">Add Web Sources</h4>
                                    <div class="flex gap-2">
                                        <input type="url" id="webSourceInput" class="flex-1 p-2 border border-gray-300 rounded-lg" placeholder="https://example.com/knowledge-page">
                                        <button onclick="addWebSource()" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">Add</button>
                                    </div>
                                </div>

                                <div class="mt-4">
                                    <h4 class="font-medium text-gray-700 mb-3">Quick FAQ Entry</h4>
                                    <div class="space-y-2">
                                        <input type="text" id="faqQuestion" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="Question...">
                                        <textarea id="faqAnswer" class="w-full p-2 border border-gray-300 rounded-lg" rows="2" placeholder="Answer..."></textarea>
                                        <button onclick="addFAQ()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">Add FAQ</button>
                                    </div>
                                </div>
                            </div>

                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-search mr-2 text-indigo-600"></i>
                                    Knowledge Base Search
                                </h3>
                                
                                <div class="flex gap-2 mb-4">
                                    <input type="text" id="searchInput" class="flex-1 p-2 border border-gray-300 rounded-lg" placeholder="Search knowledge base...">
                                    <button onclick="searchKnowledge()" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">Search</button>
                                </div>

                                <div id="searchResults" class="space-y-2">
                                    <!-- Search results will appear here -->
                                </div>
                            </div>
                        </div>

                        <div class="space-y-6">
                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-database mr-2 text-indigo-600"></i>
                                    Knowledge Sources
                                </h3>
                                
                                <div id="knowledgeSourcesList" class="space-y-3">
                                    <!-- Example knowledge sources -->
                                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                        <div class="flex items-center">
                                            <i class="fas fa-file-pdf text-red-500 mr-3"></i>
                                            <div>
                                                <div class="font-medium">Hospital Policies.pdf</div>
                                                <div class="text-sm text-gray-500">2.3 MB • Added 2 hours ago</div>
                                            </div>
                                        </div>
                                        <div class="flex gap-2">
                                            <button class="text-indigo-600 hover:text-indigo-800">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="text-red-600 hover:text-red-800">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>

                                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                        <div class="flex items-center">
                                            <i class="fas fa-globe text-blue-500 mr-3"></i>
                                            <div>
                                                <div class="font-medium">FAQ Database</div>
                                                <div class="text-sm text-gray-500">25 entries • Updated daily</div>
                                            </div>
                                        </div>
                                        <div class="flex gap-2">
                                            <button class="text-indigo-600 hover:text-indigo-800">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="text-red-600 hover:text-red-800">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>

                                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                        <div class="flex items-center">
                                            <i class="fas fa-file-alt text-green-500 mr-3"></i>
                                            <div>
                                                <div class="font-medium">Treatment Guidelines</div>
                                                <div class="text-sm text-gray-500">1.8 MB • Medical protocols</div>
                                            </div>
                                        </div>
                                        <div class="flex gap-2">
                                            <button class="text-indigo-600 hover:text-indigo-800">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="text-red-600 hover:text-red-800">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-4 p-3 bg-blue-50 rounded-lg">
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm font-medium">Knowledge Base Size</span>
                                        <span class="text-sm">4.1 MB</span>
                                    </div>
                                    <div class="mt-2 bg-blue-200 rounded-full h-2">
                                        <div class="bg-blue-600 h-2 rounded-full" style="width: 35%"></div>
                                    </div>
                                    <div class="text-xs text-gray-600 mt-1">3.5 MB of 10 MB used</div>
                                </div>
                            </div>

                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-magic mr-2 text-indigo-600"></i>
                                    AI Enhancement Settings
                                </h3>
                                
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Auto-categorization</div>
                                            <div class="text-sm text-gray-600">Automatically categorize new knowledge</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Smart Summarization</div>
                                            <div class="text-sm text-gray-600">Create AI-powered summaries</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Semantic Search</div>
                                            <div class="text-sm text-gray-600">Enable meaning-based search</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Auto-updates</div>
                                            <div class="text-sm text-gray-600">Keep knowledge base current</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Conversation Flows Tab -->
                <div id="conversation-content" class="tab-content">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-6">
                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-sitemap mr-2 text-indigo-600"></i>
                                    Conversation Flow Designer
                                </h3>
                                
                                <div class="flow-designer" id="flowDesigner">
                                    <div class="text-center text-gray-500 py-12">
                                        <i class="fas fa-project-diagram text-4xl mb-4"></i>
                                        <p>Visual Flow Designer</p>
                                        <p class="text-sm">Drag and drop to create conversation flows</p>
                                        <button class="mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700" onclick="createNewFlow()">
                                            <i class="fas fa-plus mr-2"></i>Create New Flow
                                        </button>
                                    </div>
                                </div>

                                <div class="mt-4 flex gap-2">
                                    <button class="px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200" onclick="addNode('start')">
                                        <i class="fas fa-play mr-1"></i>Start
                                    </button>
                                    <button class="px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200" onclick="addNode('question')">
                                        <i class="fas fa-question mr-1"></i>Question
                                    </button>
                                    <button class="px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200" onclick="addNode('condition')">
                                        <i class="fas fa-code-branch mr-1"></i>Condition
                                    </button>
                                    <button class="px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200" onclick="addNode('action')">
                                        <i class="fas fa-cog mr-1"></i>Action
                                    </button>
                                    <button class="px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200" onclick="addNode('end')">
                                        <i class="fas fa-stop mr-1"></i>End
                                    </button>
                                </div>
                            </div>

                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-list mr-2 text-indigo-600"></i>
                                    Predefined Flow Templates
                                </h3>
                                
                                <div class="space-y-3">
                                    <div class="p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer" onclick="loadFlowTemplate('appointment')">
                                        <div class="font-medium">Appointment Booking</div>
                                        <div class="text-sm text-gray-600">Complete flow for medical appointments</div>
                                    </div>

                                    <div class="p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer" onclick="loadFlowTemplate('support')">
                                        <div class="font-medium">Customer Support</div>
                                        <div class="text-sm text-gray-600">Issue resolution and escalation</div>
                                    </div>

                                    <div class="p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer" onclick="loadFlowTemplate('information')">
                                        <div class="font-medium">Information Request</div>
                                        <div class="text-sm text-gray-600">Handle general inquiries</div>
                                    </div>

                                    <div class="p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer" onclick="loadFlowTemplate('emergency')">
                                        <div class="font-medium">Emergency Handling</div>
                                        <div class="text-sm text-gray-600">Critical situation management</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="space-y-6">
                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-edit mr-2 text-indigo-600"></i>
                                    Flow Properties
                                </h3>
                                
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Flow Name</label>
                                        <input type="text" id="flowName" class="w-full p-2 border border-gray-300 rounded-lg" value="Healthcare Appointment Flow">
                                    </div>

                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                        <textarea id="flowDescription" class="w-full p-2 border border-gray-300 rounded-lg" rows="2">Complete conversation flow for booking medical appointments with intelligent branching and fallback handling.</textarea>
                                    </div>

                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Trigger Intent</label>
                                        <select id="triggerIntent" class="w-full p-2 border border-gray-300 rounded-lg">
                                            <option value="appointment_booking" selected>Appointment Booking</option>
                                            <option value="information_request">Information Request</option>
                                            <option value="complaint">Complaint</option>
                                            <option value="emergency">Emergency</option>
                                        </select>
                                    </div>

                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Priority Level</label>
                                        <select id="flowPriority" class="w-full p-2 border border-gray-300 rounded-lg">
                                            <option value="high" selected>High</option>
                                            <option value="medium">Medium</option>
                                            <option value="low">Low</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-chart-line mr-2 text-indigo-600"></i>
                                    Flow Performance
                                </h3>
                                
                                <div class="space-y-4">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm font-medium">Success Rate</span>
                                        <span class="text-lg font-bold text-green-600">87%</span>
                                    </div>

                                    <div class="flex justify-between items-center">
                                        <span class="text-sm font-medium">Avg Completion Time</span>
                                        <span class="text-lg font-bold text-blue-600">3.2 min</span>
                                    </div>

                                    <div class="flex justify-between items-center">
                                        <span class="text-sm font-medium">User Satisfaction</span>
                                        <span class="text-lg font-bold text-purple-600">4.6/5</span>
                                    </div>

                                    <div class="flex justify-between items-center">
                                        <span class="text-sm font-medium">Escalation Rate</span>
                                        <span class="text-lg font-bold text-orange-600">12%</span>
                                    </div>
                                </div>

                                <div class="mt-4">
                                    <h4 class="font-medium mb-2">Recent Improvements</h4>
                                    <div class="text-sm text-gray-600 space-y-1">
                                        <div>• Reduced steps by 15%</div>
                                        <div>• Improved intent recognition</div>
                                        <div>• Added fallback paths</div>
                                    </div>
                                </div>
                            </div>

                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-tools mr-2 text-indigo-600"></i>
                                    Flow Actions
                                </h3>
                                
                                <div class="space-y-3">
                                    <button class="w-full px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700" onclick="testFlow()">
                                        <i class="fas fa-play mr-2"></i>Test Flow
                                    </button>

                                    <button class="w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700" onclick="saveFlow()">
                                        <i class="fas fa-save mr-2"></i>Save Flow
                                    </button>

                                    <button class="w-full px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700" onclick="exportFlow()">
                                        <i class="fas fa-download mr-2"></i>Export Flow
                                    </button>

                                    <button class="w-full px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700" onclick="duplicateFlow()">
                                        <i class="fas fa-copy mr-2"></i>Duplicate Flow
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Analytics & Testing Tab -->
                <div id="analytics-content" class="tab-content">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-6">
                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-vial mr-2 text-indigo-600"></i>
                                    Agent Testing
                                </h3>
                                
                                <div class="conversation-preview" id="testConversation">
                                    <div class="text-center text-gray-500 py-8">
                                        <i class="fas fa-comments text-3xl mb-3"></i>
                                        <p>Start a test conversation</p>
                                        <button class="mt-3 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700" onclick="startTestConversation()">
                                            Begin Test
                                        </button>
                                    </div>
                                </div>

                                <div class="mt-4">
                                    <div class="flex gap-2">
                                        <input type="text" id="testMessage" class="flex-1 p-2 border border-gray-300 rounded-lg" placeholder="Type a test message..." onkeypress="handleTestKeypress(event)">
                                        <button onclick="sendTestMessage()" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">Send</button>
                                    </div>
                                </div>

                                <div class="mt-4 flex gap-2">
                                    <button onclick="loadTestScenario('appointment')" class="px-3 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200">Appointment</button>
                                    <button onclick="loadTestScenario('complaint')" class="px-3 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200">Complaint</button>
                                    <button onclick="loadTestScenario('emergency')" class="px-3 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200">Emergency</button>
                                    <button onclick="loadTestScenario('mixed')" class="px-3 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200">Hinglish</button>
                                </div>
                            </div>

                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-chart-bar mr-2 text-indigo-600"></i>
                                    Performance Analytics
                                </h3>
                                
                                <div class="analytics-chart">
                                    <div class="text-center">
                                        <div class="text-3xl text-indigo-600 mb-2">📊</div>
                                        <p class="text-gray-600">Conversation Success Rate</p>
                                        <p class="text-2xl font-bold text-indigo-600">92%</p>
                                    </div>
                                </div>

                                <div class="grid grid-cols-2 gap-4 mt-4">
                                    <div class="text-center">
                                        <div class="text-xl font-bold text-green-600">4.7/5</div>
                                        <div class="text-sm text-gray-600">User Satisfaction</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-xl font-bold text-blue-600">1.2s</div>
                                        <div class="text-sm text-gray-600">Avg Response Time</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="space-y-6">
                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-brain mr-2 text-indigo-600"></i>
                                    Intelligence Scores
                                </h3>
                                
                                <div class="space-y-4">
                                    <div>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm font-medium">Intent Recognition</span>
                                            <span class="text-sm font-bold">94%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-gradient-to-r from-green-400 to-green-600 h-3 rounded-full" style="width: 94%"></div>
                                        </div>
                                    </div>

                                    <div>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm font-medium">Context Retention</span>
                                            <span class="text-sm font-bold">89%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-gradient-to-r from-blue-400 to-blue-600 h-3 rounded-full" style="width: 89%"></div>
                                        </div>
                                    </div>

                                    <div>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm font-medium">Emotion Detection</span>
                                            <span class="text-sm font-bold">96%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-gradient-to-r from-purple-400 to-purple-600 h-3 rounded-full" style="width: 96%"></div>
                                        </div>
                                    </div>

                                    <div>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm font-medium">Response Quality</span>
                                            <span class="text-sm font-bold">91%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-gradient-to-r from-orange-400 to-orange-600 h-3 rounded-full" style="width: 91%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-cogs mr-2 text-indigo-600"></i>
                                    Optimization Suggestions
                                </h3>
                                
                                <div class="space-y-3">
                                    <div class="p-3 bg-green-50 border border-green-200 rounded-lg">
                                        <div class="flex items-center">
                                            <i class="fas fa-check-circle text-green-600 mr-2"></i>
                                            <span class="text-sm font-medium">High Performance</span>
                                        </div>
                                        <div class="text-sm text-gray-600 mt-1">Intent recognition is performing excellently</div>
                                    </div>

                                    <div class="p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                                        <div class="flex items-center">
                                            <i class="fas fa-exclamation-triangle text-yellow-600 mr-2"></i>
                                            <span class="text-sm font-medium">Improve Context</span>
                                        </div>
                                        <div class="text-sm text-gray-600 mt-1">Consider extending conversation memory</div>
                                    </div>

                                    <div class="p-3 bg-blue-50 border border-blue-200 rounded-lg">
                                        <div class="flex items-center">
                                            <i class="fas fa-lightbulb text-blue-600 mr-2"></i>
                                            <span class="text-sm font-medium">Enhancement</span>
                                        </div>
                                        <div class="text-sm text-gray-600 mt-1">Add more conversation examples for better training</div>
                                    </div>
                                </div>
                            </div>

                            <div class="intelligence-card">
                                <h3 class="font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-rocket mr-2 text-indigo-600"></i>
                                    Deployment
                                </h3>
                                
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Deployment Mode</label>
                                        <select id="deploymentMode" class="w-full p-2 border border-gray-300 rounded-lg">
                                            <option value="test">Test Mode (Free)</option>
                                            <option value="staging">Staging Environment</option>
                                            <option value="production">Production (Live)</option>
                                        </select>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Auto-scaling</div>
                                            <div class="text-sm text-gray-600">Handle traffic spikes automatically</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium">Real-time Monitoring</div>
                                            <div class="text-sm text-gray-600">Monitor performance and errors</div>
                                        </div>
                                        <label class="feature-toggle">
                                            <input type="checkbox" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>

                                    <button class="w-full px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium" onclick="deployAgent()">
                                        <i class="fas fa-rocket mr-2"></i>Deploy Intelligent Agent
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentAgent = {
            id: null,
            name: 'Dr. Smart Assistant',
            config: {},
            knowledgeSources: [],
            conversationFlows: [],
            testSession: null
        };

        // Tab management
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName + '-content').classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
        }

        // Slider value updates
        function updateSliderValue(type, value) {
            document.getElementById(type + 'Value').textContent = value;
            updatePreview();
        }

        // Update agent type features
        function updateAgentTypeFeatures() {
            const agentType = document.getElementById('agentType').value;
            updatePreview();
            
            // Here you would load specific capabilities and templates for the agent type
            console.log('Agent type changed to:', agentType);
        }

        // Preview update
        function updatePreview() {
            const agentName = document.getElementById('agentName').value || 'Assistant';
            const empathy = parseFloat(document.getElementById('empathyLevel').value);
            const formality = parseFloat(document.getElementById('formalityLevel').value);
            
            let greeting = `नमस्ते! मैं ${agentName} हूं।`;
            
            if (empathy > 0.7) {
                greeting += " मैं आपकी पूरी सहायता करने के लिए यहां हूं।";
            }
            
            if (formality < 0.5) {
                greeting += " आपकी कैसे help कर सकता हूं?";
            } else {
                greeting += " आपकी कैसे सेवा कर सकता हूं?";
            }
            
            document.getElementById('previewMessage').textContent = greeting;
        }

        // Knowledge base functions
        function handleFileUpload(files) {
            Array.from(files).forEach(file => {
                addKnowledgeSource({
                    name: file.name,
                    type: 'file',
                    size: file.size,
                    file: file
                });
            });
        }

        function addWebSource() {
            const url = document.getElementById('webSourceInput').value;
            if (url) {
                addKnowledgeSource({
                    name: url,
                    type: 'web',
                    size: 'Unknown',
                    url: url
                });
                document.getElementById('webSourceInput').value = '';
            }
        }

        function addFAQ() {
            const question = document.getElementById('faqQuestion').value;
            const answer = document.getElementById('faqAnswer').value;
            
            if (question && answer) {
                addKnowledgeSource({
                    name: `FAQ: ${question.substring(0, 30)}...`,
                    type: 'faq',
                    size: 'Small',
                    question: question,
                    answer: answer
                });
                
                document.getElementById('faqQuestion').value = '';
                document.getElementById('faqAnswer').value = '';
            }
        }

        function addKnowledgeSource(source) {
            currentAgent.knowledgeSources.push(source);
            updateKnowledgeSourcesList();
        }

        function updateKnowledgeSourcesList() {
            // This would update the knowledge sources list display
            console.log('Knowledge sources updated:', currentAgent.knowledgeSources);
        }

        function searchKnowledge() {
            const query = document.getElementById('searchInput').value;
            if (query) {
                // Simulate search results
                const results = [
                    { title: 'Hospital Policies', excerpt: 'Visiting hours are 9 AM to 6 PM...', relevance: 0.9 },
                    { title: 'FAQ Database', excerpt: 'How to book appointment: Call or use online...', relevance: 0.8 }
                ];
                
                displaySearchResults(results);
            }
        }

        function displaySearchResults(results) {
            const container = document.getElementById('searchResults');
            container.innerHTML = results.map(result => `
                <div class="p-3 bg-gray-50 rounded-lg">
                    <div class="font-medium">${result.title}</div>
                    <div class="text-sm text-gray-600">${result.excerpt}</div>
                    <div class="text-xs text-indigo-600 mt-1">Relevance: ${(result.relevance * 100).toFixed(0)}%</div>
                </div>
            `).join('');
        }

        // Flow designer functions
        function createNewFlow() {
            const flowDesigner = document.getElementById('flowDesigner');
            flowDesigner.innerHTML = `
                <div class="flow-node" data-type="start">
                    <i class="fas fa-play text-green-600 mb-2"></i>
                    <div class="font-medium">Start</div>
                    <div class="text-sm text-gray-600">Flow begins here</div>
                </div>
            `;
        }

        function addNode(nodeType) {
            const flowDesigner = document.getElementById('flowDesigner');
            const nodeConfig = {
                start: { icon: 'fas fa-play', color: 'green', title: 'Start', desc: 'Flow begins here' },
                question: { icon: 'fas fa-question', color: 'blue', title: 'Question', desc: 'Ask user for input' },
                condition: { icon: 'fas fa-code-branch', color: 'purple', title: 'Condition', desc: 'Branch based on logic' },
                action: { icon: 'fas fa-cog', color: 'orange', title: 'Action', desc: 'Perform an action' },
                end: { icon: 'fas fa-stop', color: 'red', title: 'End', desc: 'Flow ends here' }
            };
            
            const config = nodeConfig[nodeType];
            const node = document.createElement('div');
            node.className = 'flow-node';
            node.innerHTML = `
                <i class="${config.icon} text-${config.color}-600 mb-2"></i>
                <div class="font-medium">${config.title}</div>
                <div class="text-sm text-gray-600">${config.desc}</div>
            `;
            
            flowDesigner.appendChild(node);
        }

        function loadFlowTemplate(templateType) {
            console.log('Loading flow template:', templateType);
            createNewFlow();
            // Here you would load the specific template
        }

        function testFlow() {
            alert('Flow testing initiated. This would start a comprehensive flow test.');
        }

        function saveFlow() {
            alert('Flow saved successfully!');
        }

        function exportFlow() {
            alert('Flow exported to JSON format.');
        }

        function duplicateFlow() {
            alert('Flow duplicated successfully!');
        }

        // Testing functions
        function startTestConversation() {
            const container = document.getElementById('testConversation');
            container.innerHTML = `
                <div class="message-bubble agent-message">
                    <div class="font-medium text-sm text-gray-600 mb-1">Agent</div>
                    <div>नमस्ते! मैं Dr. Smart Assistant हूं। आपकी कैसे सहायता कर सकता हूं?</div>
                </div>
            `;
            
            currentAgent.testSession = {
                active: true,
                messages: []
            };
        }

        function sendTestMessage() {
            const input = document.getElementById('testMessage');
            const message = input.value.trim();
            
            if (message && currentAgent.testSession?.active) {
                addTestMessage('user', message);
                input.value = '';
                
                // Simulate AI response
                setTimeout(() => {
                    const response = generateTestResponse(message);
                    addTestMessage('agent', response);
                }, 1000);
            }
        }

        function handleTestKeypress(event) {
            if (event.key === 'Enter') {
                sendTestMessage();
            }
        }

        function addTestMessage(role, content) {
            const container = document.getElementById('testConversation');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message-bubble ${role}-message`;
            messageDiv.innerHTML = `
                <div class="font-medium text-sm text-gray-600 mb-1">${role === 'user' ? 'User' : 'Agent'}</div>
                <div>${content}</div>
            `;
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        function generateTestResponse(userMessage) {
            const responses = {
                'appointment': 'बिल्कुल! मैं आपका appointment book करने में help करूंगा। Please बताएं आपका name और preferred date?',
                'help': 'मैं आपकी कई तरह से सहायता कर सकता हूं - appointment booking, health information, या कोई भी questions के लिए।',
                'problem': 'मुझे खुशी होगी आपकी problem solve करने में। Please detail में बताएं कि क्या issue है?'
            };
            
            const lowerMessage = userMessage.toLowerCase();
            
            if (lowerMessage.includes('appointment') || lowerMessage.includes('अपॉइंटमेंट')) {
                return responses.appointment;
            } else if (lowerMessage.includes('help') || lowerMessage.includes('मदद')) {
                return responses.help;
            } else if (lowerMessage.includes('problem') || lowerMessage.includes('समस्या')) {
                return responses.problem;
            }
            
            return 'मैं आपकी बात समझ गया। क्या आप और detail में बता सकते हैं कि आपको क्या चाहिए?';
        }

        function loadTestScenario(scenario) {
            const scenarios = {
                appointment: "Hello, मुझे appointment book करना है",
                complaint: "मुझे बहुत pain हो रहा है stomach में",
                emergency: "Emergency! मेरी मां को chest pain हो रहा है",
                mixed: "Hi doctor, मुझे कल appointment चाहिए for checkup"
            };
            
            document.getElementById('testMessage').value = scenarios[scenario];
        }

        // Main functions
        function testAgent() {
            alert('Starting comprehensive agent test...\n\n' +
                  '✓ Testing conversation flows\n' +
                  '✓ Validating knowledge base\n' +
                  '✓ Checking response quality\n' +
                  '✓ Performance analysis\n\n' +
                  'Test completed successfully!');
        }

        async function deployAgent() {
            const deploymentMode = document.getElementById('deploymentMode').value;
            
            // Show deployment progress
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Deploying...';
            btn.disabled = true;
            
            try {
                // Simulate deployment process
                await new Promise(resolve => setTimeout(resolve, 3000));
                
                // Simulate API call to deploy agent
                const agentData = {
                    name: document.getElementById('agentName').value,
                    description: document.getElementById('agentDescription').value,
                    agent_type: document.getElementById('agentType').value,
                    response_style: document.getElementById('responseStyle').value,
                    empathy_level: parseFloat(document.getElementById('empathyLevel').value),
                    formality_level: parseFloat(document.getElementById('formalityLevel').value),
                    patience_level: parseFloat(document.getElementById('patienceLevel').value),
                    detail_level: parseFloat(document.getElementById('detailLevel').value),
                    deployment_mode: deploymentMode,
                    intelligence_features: {
                        intent_recognition: true,
                        entity_extraction: true,
                        context_memory: true,
                        sentiment_analysis: true,
                        multi_language: true
                    },
                    knowledge_sources: currentAgent.knowledgeSources,
                    conversation_flows: currentAgent.conversationFlows
                };
                
                // Here you would make the actual API call
                // const response = await fetch('/api/intelligent-agents', {
                //     method: 'POST',
                //     headers: { 'Content-Type': 'application/json' },
                //     body: JSON.stringify(agentData)
                // });
                
                btn.innerHTML = '<i class="fas fa-check mr-2"></i>Deployed Successfully!';
                btn.classList.remove('bg-green-600', 'hover:bg-green-700');
                btn.classList.add('bg-green-700');
                
                setTimeout(() => {
                    alert('🎉 Intelligent Agent Deployed Successfully!\n\n' +
                          `Agent ID: ${agentData.name.replace(/\s+/g, '_').toLowerCase()}_${Date.now()}\n` +
                          `Mode: ${deploymentMode}\n` +
                          `Intelligence Score: 92%\n\n` +
                          'Your intelligent voice agent is now ready to handle conversations!');
                }, 1000);
                
            } catch (error) {
                console.error('Deployment error:', error);
                btn.innerHTML = originalText;
                btn.disabled = false;
                alert('❌ Deployment failed. Please try again.');
            }
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            updatePreview();
            
            // Setup drag and drop for knowledge upload
            const uploadArea = document.getElementById('knowledgeUpload');
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                handleFileUpload(e.dataTransfer.files);
            });
        });
    </script>
</body>
</html>